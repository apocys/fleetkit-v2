<!-- ITERATION LOG
Loop 1: Initial dashboard build â€” theme selector + iframe loader + sidebar
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpawnKit â€” Your AI Office</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&display=swap');

        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --bg-dark: #0a0a0a;
            --bg-card: rgba(20, 20, 20, 0.85);
            --text-primary: #e0e0e0;
            --text-muted: #888;
            --accent-cyan: #00ffff;
            --accent-pink: #ff00ff;
            --accent-green: #22cc44;
            --sidebar-width: 320px;
            --sidebar-bg: rgba(10, 10, 10, 0.92);
        }

        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            min-height: 100vh;
            overflow: hidden;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           THEME SELECTOR (full-screen, first visit)
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #theme-selector {
            position: fixed; inset: 0;
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            z-index: 900;
            overflow-y: auto;
            padding: 40px 20px;
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        #theme-selector.hidden {
            opacity: 0; transform: scale(0.95);
            pointer-events: none;
        }

        /* Animated starfield background */
        #theme-selector::before {
            content: '';
            position: fixed; top: 0; left: 0;
            width: 100%; height: 200%;
            background-image:
                radial-gradient(circle at 25% 25%, rgba(255,255,255,0.1) 1px, transparent 1px),
                radial-gradient(circle at 75% 75%, rgba(255,255,255,0.05) 1px, transparent 1px),
                radial-gradient(circle at 50% 10%, rgba(0,255,255,0.08) 1px, transparent 1px);
            background-size: 100px 100px, 150px 150px, 200px 200px;
            animation: starfield 60s linear infinite;
            pointer-events: none; z-index: -1;
        }
        @keyframes starfield {
            0% { transform: translateY(0); }
            100% { transform: translateY(-100px); }
        }

        .sel-header { text-align: center; margin-bottom: 36px; z-index: 1; }
        .sel-logo {
            font-size: 3rem; font-weight: 700;
            background: linear-gradient(45deg, #00ffff, #ff00ff, #ffff00);
            background-size: 300% 300%;
            -webkit-background-clip: text; background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradShift 3s ease-in-out infinite alternate;
            letter-spacing: 5px;
        }
        @keyframes gradShift {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }
        .sel-tagline { font-size: 1.05rem; color: #ccc; margin-top: 10px; }
        .sel-subtitle {
            font-size: 0.8rem; color: #666; margin-top: 18px;
            text-transform: uppercase; letter-spacing: 3px;
        }

        /* Card grid */
        .sel-cards {
            display: flex; gap: 28px; flex-wrap: wrap;
            justify-content: center; z-index: 1;
        }
        .sel-card {
            background: var(--bg-card);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 14px;
            width: 280px; padding: 24px;
            display: flex; flex-direction: column;
            align-items: center; text-align: center;
            cursor: pointer;
            transition: all 0.35s ease;
            backdrop-filter: blur(12px);
            position: relative; overflow: hidden;
            opacity: 0; transform: translateY(40px);
        }
        .sel-card.visible { opacity: 1; transform: translateY(0); }
        .sel-card::before {
            content: '';
            position: absolute; inset: -2px;
            border-radius: 14px; z-index: -1;
            opacity: 0; transition: opacity 0.35s ease;
        }
        .sel-card:hover {
            transform: translateY(-8px) scale(1.02);
            border-color: rgba(255,255,255,0.3);
            box-shadow: 0 20px 50px rgba(0,0,0,0.4);
        }
        .sel-card:hover::before { opacity: 1; }

        .sel-card[data-theme="gameboy"]::before { background: linear-gradient(45deg, #9BBB0F, #306230); }
        .sel-card[data-theme="gameboy-color"]::before { background: linear-gradient(135deg, #ff6688, #66ccff, #88ff66); }
        .sel-card[data-theme="sims"]::before { background: linear-gradient(45deg, #00ff00, #1a3a4a); }

        .sel-emoji { font-size: 3rem; margin-bottom: 12px; animation: floatEmoji 3s ease-in-out infinite; }
        @keyframes floatEmoji {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-8px); }
        }
        .sel-name { font-size: 1.35rem; font-weight: 600; margin-bottom: 6px; }
        .sel-desc { font-size: 0.78rem; color: #aaa; margin-bottom: 16px; line-height: 1.5; }

        /* Mini previews */
        .mini-preview {
            width: 210px; height: 105px;
            border-radius: 6px; margin-bottom: 16px;
            overflow: hidden; position: relative;
            image-rendering: pixelated;
        }

        /* GameBoy preview */
        .prev-gb { background: #0F380F; border: 2px solid #306230; }
        .prev-gb .gb-label { position: absolute; top: 5px; left: 6px; color: #9BBB0F; font-size: 7px; font-family: monospace; }
        .prev-gb .gb-icon { position: absolute; top: 4px; right: 6px; font-size: 12px; }
        .prev-gb .gb-floor { position: absolute; bottom: 0; left: 0; right: 0; height: 28%; background: repeating-linear-gradient(90deg, #306230 0px, #306230 10px, #0F380F 10px, #0F380F 20px); }
        .prev-gb .gb-agent { position: absolute; width: 12px; height: 16px; background: #9BBB0F; border-radius: 3px 3px 0 0; bottom: 28%; }
        .prev-gb .gb-agent::after { content: ''; position: absolute; top: 3px; left: 2px; width: 3px; height: 2px; background: #0F380F; box-shadow: 5px 0 0 #0F380F; }
        .prev-gb .gb-agent:nth-child(3) { left: 20px; }
        .prev-gb .gb-agent:nth-child(4) { left: 60px; }
        .prev-gb .gb-agent:nth-child(5) { left: 100px; }
        .prev-gb .gb-desk { position: absolute; width: 18px; height: 7px; background: #8BAC0F; bottom: 28%; }
        .prev-gb .gb-desk:nth-child(6) { left: 38px; }
        .prev-gb .gb-desk:nth-child(7) { left: 78px; }
        .prev-gb .gb-desk:nth-child(8) { left: 126px; }

        /* GameBoy Color preview */
        .prev-gbc { background: #1a0a2a; border: 2px solid #6644aa; }
        .prev-gbc .gbc-label { position: absolute; top: 5px; left: 6px; color: #ff88cc; font-size: 7px; font-family: monospace; }
        .prev-gbc .gbc-icon { position: absolute; top: 4px; right: 6px; font-size: 12px; }
        .prev-gbc .gbc-floor { position: absolute; bottom: 0; left: 0; right: 0; height: 28%; background: #1a0a2a; }
        .prev-gbc .gbc-agent { position: absolute; width: 12px; height: 16px; border-radius: 3px 3px 0 0; bottom: 28%; }
        .prev-gbc .gbc-agent::after { content: ''; position: absolute; top: 3px; left: 2px; width: 3px; height: 2px; background: #1a0a2a; box-shadow: 5px 0 0 #1a0a2a; }
        .prev-gbc .gbc-agent:nth-child(3) { left: 20px; background: #ff6688; }
        .prev-gbc .gbc-agent:nth-child(4) { left: 60px; background: #66ccff; }
        .prev-gbc .gbc-agent:nth-child(5) { left: 100px; background: #88ff66; }
        .prev-gbc .gbc-desk { position: absolute; width: 18px; height: 7px; background: #8866cc; bottom: 28%; }
        .prev-gbc .gbc-desk:nth-child(6) { left: 38px; }
        .prev-gbc .gbc-desk:nth-child(7) { left: 78px; }
        .prev-gbc .gbc-desk:nth-child(8) { left: 126px; }

        /* Sims preview */
        .prev-sims { background: #e8d8b8; border: 2px solid #b8a888; position: relative; }
        .prev-sims .sims-title { position: absolute; top: 4px; left: 50%; transform: translateX(-50%); font-size: 8px; color: #2a2a2a; font-family: monospace; }
        .prev-sims .plumbob { position: absolute; top: 16px; left: 50%; transform: translateX(-50%); }
        .prev-sims .plumbob-top { width: 0; height: 0; border-left: 6px solid transparent; border-right: 6px solid transparent; border-bottom: 8px solid #00ff00; margin: 0 auto; animation: plumbobPulse 2s ease-in-out infinite; }
        .prev-sims .plumbob-bot { width: 0; height: 0; border-left: 6px solid transparent; border-right: 6px solid transparent; border-top: 8px solid #00cc00; margin: 0 auto; }
        .prev-sims .plumbob-body { width: 8px; height: 12px; background: #8833aa; margin: 2px auto; border-radius: 1px; }
        @keyframes plumbobPulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
        .prev-sims .sims-bar-area { position: absolute; bottom: 0; left: 0; right: 0; height: 22px; background: linear-gradient(180deg, #2a4858, #1a3a4a); display: flex; align-items: center; padding: 0 6px; gap: 4px; }
        .prev-sims .sims-bars { flex: 1; display: flex; flex-direction: column; gap: 1px; }
        .prev-sims .sims-bars div { height: 3px; border-radius: 1px; }
        .prev-sims .sims-bars div:nth-child(1) { background: #00cc00; width: 80%; }
        .prev-sims .sims-bars div:nth-child(2) { background: #cccc00; width: 50%; }
        .prev-sims .sims-bars div:nth-child(3) { background: #cc0000; width: 30%; }

        /* Color bar */
        .sel-colors {
            width: 100%; height: 5px;
            border-radius: 3px; margin-bottom: 16px;
            position: relative; overflow: hidden;
        }
        .sel-card[data-theme="gameboy"] .sel-colors { background: linear-gradient(90deg, #0F380F, #306230, #8BAC0F, #9BBB0F); }
        .sel-card[data-theme="gameboy-color"] .sel-colors { background: linear-gradient(90deg, #ff6688, #66ccff, #88ff66, #ffcc44); }
        .sel-card[data-theme="sims"] .sel-colors { background: linear-gradient(90deg, #00ff00, #ffcc00, #ff6644, #8833aa); }
        .sel-colors::after {
            content: ''; position: absolute; top: 0; left: -100%;
            width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.35), transparent);
            animation: shimmer 2.2s ease-in-out infinite;
        }
        @keyframes shimmer { 0% { left: -100%; } 100% { left: 100%; } }

        /* Enter button */
        .sel-btn {
            background: rgba(255,255,255,0.08);
            border: 2px solid rgba(255,255,255,0.2);
            color: var(--text-primary);
            padding: 12px 28px;
            border-radius: 8px;
            font-family: 'JetBrains Mono', monospace;
            font-weight: 600; font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase; letter-spacing: 1.5px;
            min-height: 48px; min-width: 160px;
        }
        .sel-btn:hover { background: rgba(255,255,255,0.18); border-color: rgba(255,255,255,0.4); }
        .sel-card[data-theme="gameboy"] .sel-btn:hover { background: #9BBB0F; border-color: #9BBB0F; color: #0F380F; }
        .sel-card[data-theme="gameboy-color"] .sel-btn:hover { background: #66ccff; border-color: #66ccff; color: #1a0a2a; }
        .sel-card[data-theme="sims"] .sel-btn:hover { background: #00cc00; border-color: #00cc00; color: #1a3a4a; }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           OFFICE VIEW (iframe + sidebar)
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #office-view {
            position: fixed; inset: 0;
            display: none; z-index: 100;
        }
        #office-view.active { display: block; }

        #theme-iframe {
            width: 100%; height: 100%;
            border: none; background: #000;
        }

        /* Loading overlay */
        #loader {
            position: fixed; inset: 0;
            background: rgba(0,0,0,0.92);
            display: none; z-index: 950;
            flex-direction: column;
            align-items: center; justify-content: center;
        }
        #loader.active { display: flex; }
        .loader-spinner {
            width: 48px; height: 48px;
            border: 3px solid rgba(255,255,255,0.1);
            border-top-color: var(--accent-cyan);
            border-radius: 50%;
            animation: spin 0.9s linear infinite;
            margin-bottom: 18px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loader-text {
            color: var(--accent-cyan); font-size: 0.95rem;
            text-transform: uppercase; letter-spacing: 2px;
        }

        /* Hamburger menu button */
        #menu-btn {
            position: fixed; top: 12px; left: 12px;
            width: 48px; height: 48px;
            background: rgba(10,10,10,0.75);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 10px;
            cursor: pointer; z-index: 600;
            display: none;
            align-items: center; justify-content: center;
            flex-direction: column; gap: 5px;
            transition: all 0.3s ease;
            backdrop-filter: blur(8px);
        }
        #menu-btn.visible { display: flex; }
        #menu-btn:hover { background: rgba(30,30,30,0.9); border-color: rgba(255,255,255,0.3); }
        #menu-btn span {
            display: block; width: 22px; height: 2px;
            background: var(--text-primary);
            transition: all 0.3s ease;
            border-radius: 1px;
        }
        #menu-btn.open span:nth-child(1) { transform: rotate(45deg) translate(5px, 5px); }
        #menu-btn.open span:nth-child(2) { opacity: 0; }
        #menu-btn.open span:nth-child(3) { transform: rotate(-45deg) translate(5px, -5px); }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           SIDEBAR
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        #sidebar {
            position: fixed; top: 0; left: -340px;
            width: var(--sidebar-width); height: 100%;
            background: var(--sidebar-bg);
            backdrop-filter: blur(16px);
            border-right: 1px solid rgba(255,255,255,0.08);
            z-index: 500;
            transition: left 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto; overflow-x: hidden;
            display: flex; flex-direction: column;
            padding: 20px 16px 30px;
        }
        #sidebar.open { left: 0; }

        /* Sidebar backdrop for mobile */
        #sidebar-backdrop {
            position: fixed; inset: 0;
            background: rgba(0,0,0,0.5);
            z-index: 490;
            opacity: 0; pointer-events: none;
            transition: opacity 0.35s ease;
        }
        #sidebar-backdrop.visible { opacity: 1; pointer-events: auto; }

        .sb-section { margin-bottom: 24px; }
        .sb-title {
            font-size: 0.65rem; color: #555;
            text-transform: uppercase; letter-spacing: 3px;
            margin-bottom: 12px; padding-left: 4px;
        }

        /* Theme switcher */
        .sb-theme-row {
            display: flex; align-items: center;
            gap: 10px; padding: 10px 12px;
            background: rgba(255,255,255,0.04);
            border-radius: 8px; cursor: pointer;
            transition: background 0.2s ease;
            min-height: 48px;
        }
        .sb-theme-row:hover { background: rgba(255,255,255,0.08); }
        .sb-theme-row .sb-theme-emoji { font-size: 1.3rem; }
        .sb-theme-row .sb-theme-name { font-size: 0.85rem; flex: 1; }
        .sb-theme-row .sb-gear { font-size: 1rem; color: #555; transition: transform 0.3s, color 0.3s; }
        .sb-theme-row:hover .sb-gear { transform: rotate(60deg); color: #aaa; }

        /* Theme picker dropdown */
        .sb-theme-picker {
            max-height: 0; overflow: hidden;
            transition: max-height 0.35s ease;
        }
        .sb-theme-picker.open { max-height: 200px; }
        .sb-theme-option {
            display: flex; align-items: center; gap: 10px;
            padding: 10px 16px;
            cursor: pointer; font-size: 0.8rem;
            border-radius: 6px;
            transition: background 0.2s ease;
            min-height: 44px;
        }
        .sb-theme-option:hover { background: rgba(255,255,255,0.06); }
        .sb-theme-option.active { background: rgba(0,255,255,0.08); color: var(--accent-cyan); }

        /* Agent list */
        .sb-agent {
            display: flex; align-items: center; gap: 10px;
            padding: 10px 12px;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            margin-bottom: 6px;
            cursor: pointer;
            transition: background 0.2s ease;
            min-height: 52px;
        }
        .sb-agent:hover { background: rgba(255,255,255,0.07); }
        .sb-agent-sprite {
            width: 32px; height: 32px;
            background: rgba(255,255,255,0.08);
            border-radius: 6px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2rem;
            image-rendering: pixelated;
        }
        .sb-agent-info { flex: 1; min-width: 0; }
        .sb-agent-name { font-size: 0.8rem; font-weight: 600; }
        .sb-agent-status { font-size: 0.65rem; color: #777; margin-top: 2px; }
        .sb-agent-level { font-size: 0.65rem; color: var(--accent-cyan); white-space: nowrap; }

        /* XP bar */
        .sb-xp-bar {
            width: 100%; height: 3px;
            background: rgba(255,255,255,0.08);
            border-radius: 2px; margin-top: 4px;
            overflow: hidden;
        }
        .sb-xp-fill {
            height: 100%; border-radius: 2px;
            background: var(--accent-cyan);
            transition: width 0.5s ease;
        }

        /* Agent details (expanded) */
        .sb-agent-details {
            max-height: 0; overflow: hidden;
            transition: max-height 0.35s ease;
            padding: 0 12px;
        }
        .sb-agent-details.open { max-height: 200px; padding-top: 8px; padding-bottom: 8px; }
        .sb-agent-details p { font-size: 0.7rem; color: #777; line-height: 1.6; margin-bottom: 4px; }
        .sb-agent-details .detail-label { color: #555; }

        /* Create agent button */
        .sb-create-btn {
            display: flex; align-items: center; justify-content: center;
            gap: 8px;
            width: 100%; min-height: 48px;
            background: rgba(34,204,68,0.12);
            border: 2px dashed rgba(34,204,68,0.3);
            border-radius: 10px;
            color: var(--accent-green);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem; font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 6px;
        }
        .sb-create-btn:hover {
            background: rgba(34,204,68,0.2);
            border-color: rgba(34,204,68,0.5);
            transform: scale(1.02);
        }
        .sb-create-btn .plus { font-size: 1.4rem; }

        /* Mission board */
        .sb-mission {
            display: flex; align-items: center; gap: 10px;
            padding: 10px 12px;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            margin-bottom: 6px;
            min-height: 44px;
        }
        .sb-mission-icon { font-size: 1rem; }
        .sb-mission-text { font-size: 0.75rem; flex: 1; }
        .sb-mission-badge {
            font-size: 0.6rem; padding: 2px 8px;
            border-radius: 10px; font-weight: 600;
        }
        .badge-active { background: rgba(0,255,255,0.15); color: var(--accent-cyan); }
        .badge-done { background: rgba(34,204,68,0.15); color: var(--accent-green); }
        .badge-pending { background: rgba(255,255,0,0.12); color: #cccc44; }

        /* Achievements */
        .sb-achievement {
            display: flex; align-items: center; gap: 10px;
            padding: 8px 12px;
            background: rgba(255,255,255,0.03);
            border-radius: 8px;
            margin-bottom: 6px;
            min-height: 44px;
        }
        .sb-ach-icon { font-size: 1.1rem; }
        .sb-ach-info { flex: 1; }
        .sb-ach-name { font-size: 0.75rem; font-weight: 500; }
        .sb-ach-desc { font-size: 0.6rem; color: #555; margin-top: 2px; }
        .sb-ach-locked { opacity: 0.35; }

        /* Tooltip for first visit */
        .tooltip {
            position: fixed;
            background: rgba(0,255,255,0.12);
            border: 1px solid rgba(0,255,255,0.3);
            border-radius: 8px;
            padding: 10px 16px;
            font-size: 0.75rem;
            color: var(--accent-cyan);
            z-index: 700;
            opacity: 0;
            transition: opacity 0.4s ease, transform 0.4s ease;
            pointer-events: none;
            max-width: 220px;
            line-height: 1.5;
        }
        .tooltip.show { opacity: 1; pointer-events: auto; }
        .tooltip::after {
            content: ''; position: absolute;
            width: 8px; height: 8px;
            background: rgba(0,255,255,0.12);
            border-right: 1px solid rgba(0,255,255,0.3);
            border-bottom: 1px solid rgba(0,255,255,0.3);
            transform: rotate(-45deg);
            bottom: -5px; left: 20px;
        }

        /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
           MOBILE (bottom sheet sidebar)
           â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
        @media (max-width: 700px) {
            .sel-cards { flex-direction: column; align-items: center; }
            .sel-card { width: 92vw; max-width: 340px; }
            .sel-logo { font-size: 2.2rem; }

            #sidebar {
                top: auto; bottom: -100%; left: 0;
                width: 100%; height: 75vh;
                border-right: none;
                border-top: 1px solid rgba(255,255,255,0.08);
                border-radius: 18px 18px 0 0;
                transition: bottom 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            }
            #sidebar.open { bottom: 0; left: 0; }

            #menu-btn { top: auto; bottom: 12px; left: 50%; transform: translateX(-50%); }
            #menu-btn.open { bottom: calc(75vh + 12px); }
        }
    </style>
</head>
<body>

<!-- â•â•â• THEME SELECTOR â•â•â• -->
<div id="theme-selector">
    <div class="sel-header">
        <div class="sel-logo">SPAWNKIT</div>
        <div class="sel-tagline">Your AI team, visualized.</div>
        <div class="sel-subtitle">Pick your office style</div>
    </div>

    <div class="sel-cards">
        <!-- GameBoy -->
        <div class="sel-card" data-theme="gameboy">
            <div class="sel-emoji">ğŸ®</div>
            <div class="sel-name">GameBoy</div>
            <div class="sel-desc">Classic green pixel quests.<br>Like PokÃ©mon, but it's your team!</div>
            <div class="mini-preview prev-gb">
                <div class="gb-label">â–¸ QUEST: Ship Feature</div>
                <div class="gb-icon">âš”ï¸</div>
                <div class="gb-agent"></div>
                <div class="gb-agent"></div>
                <div class="gb-agent"></div>
                <div class="gb-desk"></div>
                <div class="gb-desk"></div>
                <div class="gb-desk"></div>
                <div class="gb-floor"></div>
            </div>
            <div class="sel-colors"></div>
            <button class="sel-btn">Enter Office</button>
        </div>

        <!-- GameBoy Color -->
        <div class="sel-card" data-theme="gameboy-color">
            <div class="sel-emoji">ğŸŒˆ</div>
            <div class="sel-name">GameBoy Color</div>
            <div class="sel-desc">Same PokÃ©mon soul, now in full<br>vivid RGB pixel art!</div>
            <div class="mini-preview prev-gbc">
                <div class="gbc-label">â–¸ QUEST: Color Shift</div>
                <div class="gbc-icon">ğŸŒŸ</div>
                <div class="gbc-agent"></div>
                <div class="gbc-agent"></div>
                <div class="gbc-agent"></div>
                <div class="gbc-desk"></div>
                <div class="gbc-desk"></div>
                <div class="gbc-desk"></div>
                <div class="gbc-floor"></div>
            </div>
            <div class="sel-colors"></div>
            <button class="sel-btn">Enter Office</button>
        </div>

        <!-- The Sims -->
        <div class="sel-card" data-theme="sims">
            <div class="sel-emoji">ğŸ’</div>
            <div class="sel-name">The Sims</div>
            <div class="sel-desc">Isometric office with plumbobs<br>and needs bars â€” it's 2000 again!</div>
            <div class="mini-preview prev-sims">
                <div class="sims-title">ğŸ  Office</div>
                <div class="plumbob">
                    <div class="plumbob-top"></div>
                    <div class="plumbob-bot"></div>
                    <div class="plumbob-body"></div>
                </div>
                <div class="sims-bar-area">
                    <div class="sims-bars"><div></div><div></div><div></div></div>
                </div>
            </div>
            <div class="sel-colors"></div>
            <button class="sel-btn">Enter Office</button>
        </div>
    </div>
</div>

<!-- â•â•â• OFFICE VIEW â•â•â• -->
<div id="office-view">
    <iframe id="theme-iframe" title="Office Theme"></iframe>
</div>

<!-- â•â•â• HAMBURGER BUTTON â•â•â• -->
<button id="menu-btn" aria-label="Open menu">
    <span></span><span></span><span></span>
</button>

<!-- â•â•â• SIDEBAR BACKDROP â•â•â• -->
<div id="sidebar-backdrop"></div>

<!-- â•â•â• SIDEBAR â•â•â• -->
<nav id="sidebar">
    <!-- Theme Switcher -->
    <div class="sb-section">
        <div class="sb-title">Office Style</div>
        <div class="sb-theme-row" id="sb-theme-toggle">
            <span class="sb-theme-emoji" id="sb-cur-emoji">ğŸ®</span>
            <span class="sb-theme-name" id="sb-cur-name">GameBoy</span>
            <span class="sb-gear">âš™ï¸</span>
        </div>
        <div class="sb-theme-picker" id="sb-theme-picker">
            <div class="sb-theme-option" data-theme="gameboy"><span>ğŸ®</span> GameBoy</div>
            <div class="sb-theme-option" data-theme="gameboy-color"><span>ğŸŒˆ</span> GameBoy Color</div>
            <div class="sb-theme-option" data-theme="sims"><span>ğŸ’</span> The Sims</div>
        </div>
    </div>

    <!-- Agents -->
    <div class="sb-section">
        <div class="sb-title">Your Team</div>
        <div id="agent-list"></div>
        <button class="sb-create-btn" id="create-agent-btn">
            <span class="plus">+</span> Add Team Member
        </button>
    </div>

    <!-- Missions -->
    <div class="sb-section">
        <div class="sb-title">Mission Board</div>
        <div id="mission-list"></div>
    </div>

    <!-- Achievements -->
    <div class="sb-section">
        <div class="sb-title">Achievements</div>
        <div id="achievement-list"></div>
    </div>
</nav>

<!-- â•â•â• LOADING OVERLAY â•â•â• -->
<div id="loader">
    <div class="loader-spinner"></div>
    <div class="loader-text" id="loader-text">Opening your officeâ€¦</div>
</div>

<!-- â•â•â• TOOLTIP â•â•â• -->
<div class="tooltip" id="tooltip"></div>

<script>
(function () {
    'use strict';

    /* â”€â”€â”€ CONFIG â”€â”€â”€ */
    const THEMES = {
        gameboy:        { name: 'GameBoy',       emoji: 'ğŸ®', path: './office-gameboy/index.html' },
        'gameboy-color':{ name: 'GameBoy Color', emoji: 'ğŸŒˆ', path: './office-gameboy-color/index.html' },
        sims:           { name: 'The Sims',      emoji: 'ğŸ’', path: './office-sims/index.html' }
    };

    const DEFAULT_AGENTS = [
        { id: 'a1', name: 'Nova',     sprite: 'ğŸ§™', level: 5,  xp: 72, maxXp: 100, status: 'Researchingâ€¦' },
        { id: 'a2', name: 'Cipher',   sprite: 'ğŸ¤–', level: 3,  xp: 40, maxXp: 80,  status: 'Writing code' },
        { id: 'a3', name: 'Sentinel', sprite: 'ğŸ›¡ï¸', level: 7,  xp: 88, maxXp: 120, status: 'On watch' },
        { id: 'a4', name: 'Atlas',    sprite: 'ğŸ—ºï¸', level: 2,  xp: 15, maxXp: 60,  status: 'Idle' },
        { id: 'a5', name: 'Spark',    sprite: 'âš¡', level: 4,  xp: 55, maxXp: 90,  status: 'Brainstorming' }
    ];

    const MISSIONS = [
        { icon: 'âš”ï¸', text: 'Build the landing page',    badge: 'active' },
        { icon: 'ğŸ”', text: 'Research competitor tools',  badge: 'done' },
        { icon: 'ğŸ“¦', text: 'Prepare launch checklist',   badge: 'pending' }
    ];

    const ACHIEVEMENTS = [
        { icon: 'ğŸ†', name: 'First Steps',     desc: 'Open your office for the first time', locked: false },
        { icon: 'â­', name: 'Team Builder',    desc: 'Have 5 team members',                 locked: false },
        { icon: 'ğŸš€', name: 'Mission Master',  desc: 'Complete 10 missions',                locked: true },
        { icon: 'ğŸ¨', name: 'Style Shifter',   desc: 'Try all 3 office styles',             locked: true }
    ];

    /* â”€â”€â”€ ELEMENTS â”€â”€â”€ */
    const $ = id => document.getElementById(id);
    const selectorEl   = $('theme-selector');
    const officeEl     = $('office-view');
    const iframeEl     = $('theme-iframe');
    const loaderEl     = $('loader');
    const loaderText   = $('loader-text');
    const menuBtn      = $('menu-btn');
    const sidebarEl    = $('sidebar');
    const backdropEl   = $('sidebar-backdrop');
    const themePicker  = $('sb-theme-picker');
    const themeToggle  = $('sb-theme-toggle');
    const curEmoji     = $('sb-cur-emoji');
    const curName      = $('sb-cur-name');
    const agentListEl  = $('agent-list');
    const missionListEl= $('mission-list');
    const achListEl    = $('achievement-list');
    const tooltipEl    = $('tooltip');

    let currentTheme = null;
    let sidebarOpen  = false;
    let pickerOpen   = false;
    let expandedAgent = null;
    let firstVisitTooltipShown = false;

    /* â”€â”€â”€ LOCAL STORAGE HELPERS â”€â”€â”€ */
    function loadAgents() {
        try { return JSON.parse(localStorage.getItem('spawnkit-agents')) || null; }
        catch { return null; }
    }
    function saveAgents(agents) {
        localStorage.setItem('spawnkit-agents', JSON.stringify(agents));
    }
    function getAgents() {
        return loadAgents() || [...DEFAULT_AGENTS];
    }

    /* â”€â”€â”€ INIT â”€â”€â”€ */
    function init() {
        const saved = localStorage.getItem('spawnkit-theme');

        if (saved && THEMES[saved]) {
            // Returning visitor â€” go straight to office
            selectorEl.classList.add('hidden');
            loadTheme(saved);
        } else {
            // First visit â€” show selector with entrance animation
            animateCards();
        }

        // Wire up sidebar controls
        menuBtn.addEventListener('click', toggleSidebar);
        backdropEl.addEventListener('click', closeSidebar);
        themeToggle.addEventListener('click', togglePicker);
        $('create-agent-btn').addEventListener('click', createAgent);

        // Wire up selector cards
        document.querySelectorAll('.sel-card').forEach(card => {
            const btn = card.querySelector('.sel-btn');
            card.addEventListener('click', e => { if (e.target !== btn) btn.click(); });
            btn.addEventListener('click', e => {
                e.stopPropagation();
                selectTheme(card.dataset.theme);
            });
        });

        // Wire up theme picker options
        document.querySelectorAll('.sb-theme-option').forEach(opt => {
            opt.addEventListener('click', () => switchTheme(opt.dataset.theme));
        });

        // Render sidebar data
        renderAgents();
        renderMissions();
        renderAchievements();
    }

    /* â”€â”€â”€ CARD ENTRANCE ANIMATION â”€â”€â”€ */
    function animateCards() {
        const cards = document.querySelectorAll('.sel-card');
        cards.forEach((card, i) => {
            setTimeout(() => card.classList.add('visible'), 200 + i * 180);
        });
    }

    /* â”€â”€â”€ THEME SELECTION (from selector screen) â”€â”€â”€ */
    function selectTheme(themeId) {
        if (!THEMES[themeId]) return;
        localStorage.setItem('spawnkit-theme', themeId);
        // Track for "Style Shifter" achievement
        trackThemeVisit(themeId);
        // Fade out selector
        selectorEl.classList.add('hidden');
        setTimeout(() => { selectorEl.style.display = 'none'; }, 500);
        loadTheme(themeId);
    }

    /* â”€â”€â”€ LOAD THEME INTO IFRAME â”€â”€â”€ */
    function loadTheme(themeId) {
        const theme = THEMES[themeId];
        if (!theme) return;
        currentTheme = themeId;

        // Show loader
        loaderText.textContent = `Opening ${theme.name} officeâ€¦`;
        loaderEl.classList.add('active');

        // Update sidebar current theme
        curEmoji.textContent = theme.emoji;
        curName.textContent = theme.name;
        updatePickerActive(themeId);

        // Load iframe
        iframeEl.src = theme.path;
        iframeEl.onload = () => {
            setTimeout(() => {
                loaderEl.classList.remove('active');
                officeEl.classList.add('active');
                menuBtn.classList.add('visible');
                // Show tooltip on first visit
                if (!localStorage.getItem('spawnkit-tooltip-seen')) {
                    showFirstVisitTooltip();
                }
            }, 600);
        };
        // Fallback: hide loader after 5s even if iframe doesn't fire load
        setTimeout(() => {
            if (loaderEl.classList.contains('active')) {
                loaderEl.classList.remove('active');
                officeEl.classList.add('active');
                menuBtn.classList.add('visible');
            }
        }, 5000);
    }

    /* â”€â”€â”€ SWITCH THEME (from sidebar) â”€â”€â”€ */
    function switchTheme(themeId) {
        if (!THEMES[themeId] || themeId === currentTheme) return;
        localStorage.setItem('spawnkit-theme', themeId);
        trackThemeVisit(themeId);
        closeSidebar();
        pickerOpen = false;
        themePicker.classList.remove('open');
        loadTheme(themeId);
    }

    /* â”€â”€â”€ SIDEBAR â”€â”€â”€ */
    function toggleSidebar() {
        sidebarOpen ? closeSidebar() : openSidebar();
    }
    function openSidebar() {
        sidebarOpen = true;
        sidebarEl.classList.add('open');
        menuBtn.classList.add('open');
        backdropEl.classList.add('visible');
        localStorage.setItem('spawnkit-sidebar', 'open');
    }
    function closeSidebar() {
        sidebarOpen = false;
        sidebarEl.classList.remove('open');
        menuBtn.classList.remove('open');
        backdropEl.classList.remove('visible');
        localStorage.setItem('spawnkit-sidebar', 'closed');
    }

    /* â”€â”€â”€ THEME PICKER â”€â”€â”€ */
    function togglePicker() {
        pickerOpen = !pickerOpen;
        themePicker.classList.toggle('open', pickerOpen);
    }
    function updatePickerActive(themeId) {
        document.querySelectorAll('.sb-theme-option').forEach(opt => {
            opt.classList.toggle('active', opt.dataset.theme === themeId);
        });
    }

    /* â”€â”€â”€ AGENTS â”€â”€â”€ */
    function renderAgents() {
        const agents = getAgents();
        agentListEl.innerHTML = '';
        agents.forEach(agent => {
            const row = document.createElement('div');
            row.className = 'sb-agent';
            row.innerHTML = `
                <div class="sb-agent-sprite">${agent.sprite}</div>
                <div class="sb-agent-info">
                    <div class="sb-agent-name">${agent.name}</div>
                    <div class="sb-agent-status">${agent.status}</div>
                    <div class="sb-xp-bar"><div class="sb-xp-fill" style="width:${Math.round(agent.xp / agent.maxXp * 100)}%"></div></div>
                </div>
                <div class="sb-agent-level">Lv.${agent.level}</div>
            `;
            const details = document.createElement('div');
            details.className = 'sb-agent-details';
            details.id = 'details-' + agent.id;
            details.innerHTML = `
                <p><span class="detail-label">Experience:</span> ${agent.xp} / ${agent.maxXp}</p>
                <p><span class="detail-label">Doing:</span> ${agent.status}</p>
                <p><span class="detail-label">Joined:</span> Today</p>
            `;
            row.addEventListener('click', () => {
                if (expandedAgent === agent.id) {
                    details.classList.remove('open');
                    expandedAgent = null;
                } else {
                    // Close previous
                    if (expandedAgent) {
                        const prev = document.getElementById('details-' + expandedAgent);
                        if (prev) prev.classList.remove('open');
                    }
                    details.classList.add('open');
                    expandedAgent = agent.id;
                }
            });
            agentListEl.appendChild(row);
            agentListEl.appendChild(details);
        });
    }

    function createAgent() {
        const agents = getAgents();
        const sprites = ['ğŸ±', 'ğŸ¶', 'ğŸ¦Š', 'ğŸ¸', 'ğŸ¼', 'ğŸ¦‰', 'ğŸ™', 'ğŸ¦„', 'ğŸ²', 'ğŸ¤¡'];
        const names = ['Pixel', 'Glitch', 'Byte', 'Luna', 'Rex', 'Chip', 'Bloom', 'Echo', 'Dash', 'Fern'];
        const statuses = ['Ready to help!', 'Just arrived', 'Warming upâ€¦', 'Standing by'];
        const newAgent = {
            id: 'a' + Date.now(),
            name: names[Math.floor(Math.random() * names.length)],
            sprite: sprites[Math.floor(Math.random() * sprites.length)],
            level: 1,
            xp: 0,
            maxXp: 50,
            status: statuses[Math.floor(Math.random() * statuses.length)]
        };
        agents.push(newAgent);
        saveAgents(agents);
        renderAgents();
    }

    /* â”€â”€â”€ MISSIONS â”€â”€â”€ */
    function renderMissions() {
        missionListEl.innerHTML = '';
        MISSIONS.forEach(m => {
            const el = document.createElement('div');
            el.className = 'sb-mission';
            el.innerHTML = `
                <span class="sb-mission-icon">${m.icon}</span>
                <span class="sb-mission-text">${m.text}</span>
                <span class="sb-mission-badge badge-${m.badge}">${m.badge === 'done' ? 'âœ“ Done' : m.badge === 'active' ? 'â— Active' : 'â—Œ Soon'}</span>
            `;
            missionListEl.appendChild(el);
        });
    }

    /* â”€â”€â”€ ACHIEVEMENTS â”€â”€â”€ */
    function renderAchievements() {
        achListEl.innerHTML = '';
        ACHIEVEMENTS.forEach(a => {
            const el = document.createElement('div');
            el.className = 'sb-achievement' + (a.locked ? ' sb-ach-locked' : '');
            el.innerHTML = `
                <span class="sb-ach-icon">${a.locked ? 'ğŸ”’' : a.icon}</span>
                <div class="sb-ach-info">
                    <div class="sb-ach-name">${a.name}</div>
                    <div class="sb-ach-desc">${a.desc}</div>
                </div>
            `;
            achListEl.appendChild(el);
        });
    }

    /* â”€â”€â”€ TRACK THEME VISITS (achievement) â”€â”€â”€ */
    function trackThemeVisit(themeId) {
        let visited = [];
        try { visited = JSON.parse(localStorage.getItem('spawnkit-themes-visited')) || []; } catch {}
        if (!visited.includes(themeId)) {
            visited.push(themeId);
            localStorage.setItem('spawnkit-themes-visited', JSON.stringify(visited));
        }
        // Unlock "Style Shifter" if all 3 visited
        if (visited.length >= 3) {
            const ach = ACHIEVEMENTS.find(a => a.name === 'Style Shifter');
            if (ach) ach.locked = false;
            renderAchievements();
        }
    }

    /* â”€â”€â”€ FIRST-VISIT TOOLTIP â”€â”€â”€ */
    function showFirstVisitTooltip() {
        if (firstVisitTooltipShown) return;
        firstVisitTooltipShown = true;
        tooltipEl.textContent = 'ğŸ‘‹ Tap this button anytime to see your team, switch styles, or check missions!';
        const btnRect = menuBtn.getBoundingClientRect();
        // Position tooltip near hamburger
        const isMobile = window.innerWidth <= 700;
        if (isMobile) {
            tooltipEl.style.bottom = (window.innerHeight - btnRect.top + 10) + 'px';
            tooltipEl.style.left = '50%';
            tooltipEl.style.transform = 'translateX(-50%)';
            tooltipEl.style.top = 'auto';
        } else {
            tooltipEl.style.top = (btnRect.bottom + 10) + 'px';
            tooltipEl.style.left = (btnRect.left) + 'px';
        }
        tooltipEl.classList.add('show');
        setTimeout(() => {
            tooltipEl.classList.remove('show');
            localStorage.setItem('spawnkit-tooltip-seen', '1');
        }, 5000);
        // Also dismiss on click anywhere
        document.addEventListener('click', function dismiss() {
            tooltipEl.classList.remove('show');
            localStorage.setItem('spawnkit-tooltip-seen', '1');
            document.removeEventListener('click', dismiss);
        }, { once: true });
    }

    /* â”€â”€â”€ KEYBOARD SHORTCUT â”€â”€â”€ */
    document.addEventListener('keydown', e => {
        if (e.key === 'Escape' && sidebarOpen) closeSidebar();
        if (e.key === 'm' && !sidebarOpen && officeEl.classList.contains('active')) openSidebar();
    });

    /* â”€â”€â”€ GO â”€â”€â”€ */
    document.addEventListener('DOMContentLoaded', init);
})();
</script>
</body>
</html>