<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpawnKit v2 - GameBoy Office</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        body {
            margin: 0;
            padding: 20px;
            background: #0F380F;
            color: #9BBB0F;
            font-family: 'Press Start 2P', 'Monaco', monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            background-image: 
                radial-gradient(circle at 1px 1px, #306230 1px, transparent 0);
            background-size: 4px 4px;
        }
        
        h1 {
            margin-bottom: 20px;
            color: #9BBB0F;
            text-align: center;
            font-size: 16px;
            text-shadow: 2px 2px 0px #306230;
            border: 3px solid #8BAC0F;
            padding: 10px 20px;
            background: #306230;
        }
        
        #gameContainer {
            border: 4px solid #8BAC0F;
            border-radius: 0;
            background: #9BBB0F;
            position: relative;
            box-shadow: 
                inset -2px -2px 0px #306230,
                inset 2px 2px 0px #8BAC0F;
        }
        
        #gameContainer canvas {
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }
        
        #gameHUD {
            margin-top: 12px;
            font-size: 9px;
            color: #8BAC0F;
            text-align: center;
            max-width: 800px;
            background: #0F380F;
            border: 3px solid #8BAC0F;
            border-radius: 4px;
            padding: 10px 16px;
            font-family: 'Press Start 2P', monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            box-shadow: 0 0 10px rgba(139, 172, 15, 0.3);
        }
        
        .hud-item {
            white-space: nowrap;
        }
        
        .hud-sep {
            color: #306230;
            font-size: 10px;
        }
        
        #missionPanel {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 220px;
            background: #306230;
            border: 3px solid #8BAC0F;
            padding: 10px;
            font-size: 8px;
            color: #9BBB0F;
            box-shadow: 
                inset -1px -1px 0px #0F380F,
                inset 1px 1px 0px #8BAC0F;
        }
        
        #missionPanel h3 {
            margin: 0 0 10px 0;
            font-size: 10px;
            text-align: center;
            color: #9BBB0F;
        }
        
        .mission-item {
            margin: 8px 0;
            padding: 4px;
            background: #0F380F;
            border: 1px solid #8BAC0F;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #0F380F;
            border: 1px solid #8BAC0F;
            margin-top: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: #9BBB0F;
            transition: width 0.5s ease;
        }
        
        /* ‚îÄ‚îÄ Pok√©mon HP Bar ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        .hp-bar {
            width: 100%;
            height: 4px;
            background: #0F380F;
            border: 1px solid #8BAC0F;
            margin-top: 2px;
            overflow: hidden;
            position: relative;
        }
        .hp-bar::before {
            content: 'HP';
            position: absolute;
            left: -18px;
            top: -2px;
            font-size: 5px;
            color: #9BBB0F;
        }
        .hp-fill {
            height: 100%;
            transition: width 0.5s ease, background 0.5s ease;
        }
        .hp-fill.hp-green  { background: #9BBB0F; }
        .hp-fill.hp-yellow { background: #CCBB00; }
        .hp-fill.hp-orange { background: #CC8800; }
        .hp-fill.hp-red    { background: #CC2200; }
        
        /* ‚îÄ‚îÄ Pok√©mon System Message Box ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        #pokemonSystemBox {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 80px;
            background: #0F380F;
            border-top: 4px solid #8BAC0F;
            padding: 8px 12px;
            font-size: 10px;
            color: #9BBB0F;
            display: flex;
            align-items: flex-start;
            overflow: hidden;
            box-shadow: inset 0 2px 0 #306230;
        }
        #pokemonSystemBox .poke-text {
            flex: 1;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        #pokemonSystemBox .poke-scroll {
            align-self: flex-end;
            animation: pokeScroll 0.8s infinite;
            font-size: 12px;
            margin-left: 4px;
        }
        @keyframes pokeScroll {
            0%, 60% { opacity: 1; transform: translateY(0); }
            30% { opacity: 1; transform: translateY(3px); }
            100% { opacity: 0; }
        }
        
        /* ‚îÄ‚îÄ Wild Encounter Notification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        #wildEncounter {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: #0F380F;
            display: none;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            font-size: 14px;
            color: #9BBB0F;
            z-index: 999;
            text-align: center;
            line-height: 2;
        }
        #wildEncounter.show {
            display: flex;
            animation: wildFlash 0.6s ease-out;
        }
        @keyframes wildFlash {
            0% { opacity: 0; }
            15% { opacity: 1; background: #9BBB0F; color: #0F380F; }
            30% { background: #0F380F; color: #9BBB0F; }
            45% { background: #9BBB0F; color: #0F380F; }
            60% { background: #0F380F; color: #9BBB0F; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body>
    <h1>SPAWNKIT GAMEBOY OFFICE</h1>
    
    <div style="position: relative;">
        <div id="gameContainer"></div>
        
        <div id="missionPanel">
            <h3 id="missionPanelTitle">QUEST BOARD</h3>
            <div id="currentMissions">
                <div class="mission-item">
                    <div>Status: Ready</div>
                    <div class="hp-bar">
                        <div class="hp-fill hp-green" style="width: 0%"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Pok√©mon-style system message box -->
        <div id="pokemonSystemBox">
            <span class="poke-text" id="pokeText">SPAWNKIT OFFICE is ready for battle!</span>
            <span class="poke-scroll">‚ñº</span>
        </div>
        
        <!-- Wild encounter overlay -->
        <div id="wildEncounter"></div>
    </div>
    
    <div id="gameHUD">
        <span class="hud-item" id="hudLevel">üéÆ LV.1</span>
        <span class="hud-sep">‚îÇ</span>
        <span class="hud-item" id="hudQuests">‚ö° 0 QUESTS</span>
        <span class="hud-sep">‚îÇ</span>
        <span class="hud-item" id="hudScore">üèÜ 0pts</span>
        <span class="hud-sep">‚îÇ</span>
        <span class="hud-item" id="hudStreak">üî• 0 streak</span>
        <span class="hud-sep">‚îÇ</span>
        <span class="hud-item" id="hudAgents">üë• 5 TEAM</span>
    </div>

    <!-- PixiJS v7 from CDN -->
    <script src="../lib/pixi.min.js"></script>
    
    <!-- SpawnKit v2 Visual Polish Layer -->
    <script src="../src/favicon.js"></script>
    <script src="../src/meta-tags.js"></script>
    <script src="../src/page-title.js"></script>
    
    <!-- SpawnKit v2 Theme Names (universe-consistent naming) -->
    <script src="../src/theme-names.js"></script>
    
    <!-- SpawnKit v2 Data Bridge -->
    <script src="../src/data-bridge.js"></script>
    
    <!-- SpawnKit v2 Sprites -->
    <script src="../src/sprites.js"></script>
    
    <!-- SpawnKit v2 Mission Controller (Pok√©mon-style gameplay core) -->
    <script src="../src/mission-controller.js"></script>
    
    <!-- Boot Sequence -->
    <script src="../src/boot-sequence.js"></script>
    
    <!-- Theme Switcher -->
    <script src="../src/theme-switcher.js"></script>
    
    <!-- Responsive & Transitions (after theme switcher for patching) -->
    <script src="../src/responsive.js"></script>
    <script src="../src/transitions.js"></script>
    
    <!-- Universal UX Layer -->
    <script src="../src/ux-layer.js"></script>
    <script src="../src/achievements.js"></script>
    
    <!-- OpenClaw Integration Layer -->
    <script src="../src/openclaw-helpers.js"></script>
    
    <!-- Click Affordances & Visual Buttons -->
    <script src="../src/click-affordances.js"></script>
    
    <!-- GameBoy Sound & Visual Effects -->
    <script src="gameboy-effects.js"></script>
    
    <!-- GameBoy Office engine -->
    <script src="gameboy-map.js"></script>
    <script src="gameboy-characters.js"></script>
    <script src="gameboy-state-bridge.js"></script>
    <script src="gameboy-mission-adapter.js"></script>
    <script src="gameboy-office.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', async function() {
            // Initialize UX Layer
            if (typeof SpawnKitUX !== 'undefined') {
                SpawnKitUX.init({ theme: 'gameboy' });
            }
            // Initialize OpenClaw Helpers
            if (typeof OpenClawHelpers !== 'undefined') {
                OpenClawHelpers.init({ theme: 'gameboy' });
            }
            
            const params = new URLSearchParams(window.location.search);
            const shouldBoot = params.has('boot') || !localStorage.getItem('spawnkit-booted-gameboy');
            
            if (shouldBoot && typeof SpawnKitBoot !== 'undefined') {
                // Create boot overlay
                const overlay = document.createElement('div');
                overlay.id = 'bootOverlay';
                overlay.style.cssText = 'position:fixed;top:0;left:0;width:100%;height:100%;z-index:9999;background:#0F380F;';
                document.body.prepend(overlay);
                
                try {
                    await SpawnKitBoot.play('gameboy', overlay, { 
                        soundEnabled: false, 
                        skipable: true 
                    });
                } catch(e) { console.warn('Boot skipped:', e); }
                
                localStorage.setItem('spawnkit-booted-gameboy', 'true');
                overlay.style.transition = 'opacity 0.5s';
                overlay.style.opacity = '0';
                setTimeout(() => overlay.remove(), 500);
            }
            
            initThemeSwitcher();
            
            // Signal UX layer that office is ready
            if (typeof SpawnKitUX !== 'undefined') {
                SpawnKitUX.ready();
            }
            
            // Update HUD with real data every 5 seconds
            function updateHUD() {
                try {
                    const data = typeof SpawnKit !== 'undefined' ? SpawnKit.data : null;
                    const ach = typeof SpawnKitAchievements !== 'undefined' ? SpawnKitAchievements : null;
                    
                    if (data) {
                        const activeMissions = (data.missions || []).filter(m => m.status === 'active').length;
                        const agents = (data.agents || []).length;
                        document.getElementById('hudQuests').textContent = '‚ö° ' + activeMissions + ' QUEST' + (activeMissions !== 1 ? 'S' : '');
                        document.getElementById('hudAgents').textContent = 'üë• ' + agents + ' TEAM';
                    }
                    if (ach) {
                        const stats = ach.getStats ? ach.getStats() : {};
                        const score = ach.getScore ? ach.getScore() : { score: 0, rank: 'ü•â' };
                        const streak = stats.streak || 0;
                        const level = Math.max(1, Math.floor(score.score / 50) + 1);
                        document.getElementById('hudLevel').textContent = 'üéÆ LV.' + level;
                        document.getElementById('hudScore').textContent = 'üèÜ ' + score.score + 'pts';
                        document.getElementById('hudStreak').textContent = 'üî• ' + streak + ' streak';
                    }
                } catch(e) {}
            }
            updateHUD();
            setInterval(updateHUD, 5000);
        });
    </script>
</body>
</html>
